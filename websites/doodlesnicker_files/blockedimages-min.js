/*!
 * cache=true
 * @license Licences are viewable at this URL: http://w.cdn.gaiaonline.com/src/=/e143bb5df5304ae98988a03a4dabca2e-1446-64/src/js/widgets/blockedimages-min.js
 */


/*! /src/js/widgets/blockedimages-min.js */
(function(e){var l=e.util,h=l.Dom,f=l.Event,k=e.namespace("gaia.widgets"),i="bbcode-swap-blocked-group",m="bbcode-swap-blocked-link",g="bbcode-swap-blocked-image",j="bbcode-swap-blocked-youtube",b="bbcode-unblocked-youtube",a="bbcode-swap-image-errored",d="bbcode-swapping-image",c;c=function(o,p){var n=h.generateId(o);YAHOO.util.Connect.asyncRequest("GET",["//",GAIA_config("main_server"),"/cinema/proxy.php?alt=json&site=",location.protocol,"//gdata.youtube.com/feeds/api/videos/",p].join(""),{success:function(r){var q=YAHOO.lang.JSON.parse(r.responseText);if(q.entry.media$group.media$rating){o.innerHTML="(Video is blocked)"}else{swfobject.embedSWF("https://www.youtube.com/v/"+p+"?enablejsapi=1&feature=player_embedded&rel=0&playerapiid="+n,n,425,356,"8",null,null,{allowScriptAccess:"always",wmode:"opaque"},{id:n})}},failure:function(){},scope:this})};k.BlockedImages=function(){var o,n;o=function(p,r){var q=f.getTarget(p);q.setAttribute("alt","User Image");f.removeListener(q,"load",o);f.removeListener(q,"error",n);h.removeClass(q,"bbcode-swapping-image");q.setAttribute("rel","");q.setAttribute("alt","");q.setAttribute("title","")};n=function(p,r){var q=f.getTarget(p);q.setAttribute("alt","User Image (failed to load...)");f.removeListener(q,"load",o);f.removeListener(q,"error",n);h.replaceClass(q,d,a);q.setAttribute("rel",q.getAttribute("rel"));q.setAttribute("alt","Image Failed to Load");q.setAttribute("title","Image Failed to Load")};return{unblockImage:function(p){f.addListener(p,"load",o);f.addListener(p,"error",n);p.setAttribute("src",p.getAttribute("rel"));p.setAttribute("alt","User Image (loading...)");p.setAttribute("title","");h.replaceClass(p,g,d)},unblockYouTube:function(p){h.removeClass(p,j);h.removeClass(p,b);c(p,p.getAttribute("rel"))},unblockImageGroup:function(u){var t=h.getElementsByClassName(g,"img",u),p=h.getElementsByClassName(j,"div",u),r=h.getElementsByClassName(m,null,u),s,q=0;q=t.length;while(q--){this.unblockImage(t[q])}q=p.length;while(q--){this.unblockYouTube(p[q])}q=r.length;while(q--){s=r[q];if(null!==l.Anim){h.setStyle(s,"overflow","hidden");(function(){var w=new l.Anim(s,{opacity:{to:0}},1,l.Easing.easeOut),v=function(){var x=s;x.parentNode.removeChild(x)};w.onComplete.subscribe(v);w.animate()})()}else{s.parentNode.removeChild(s);delete (s)}}h.removeClass(u,i)},init:function(){var r=h.getElementsByClassName(b,"div","content");f.addListener(document.body,"click",function(s,v){var u=f.getTarget(s),t=h.getAncestorByClassName(u,i);if(h.hasClass(u,g)||h.hasClass(u,j)||h.hasClass(u,m)){if(t){v.unblockImageGroup(t)}else{if("img"===u.tagName.toLowerCase()){if(h.hasClass(u,j)){v.unblockYoutube(u)}else{v.unblockImage(u)}}}f.stopEvent(s)}},this);for(var q=0,p=r.length;q<p;q++){this.unblockYouTube(r[q])}}}};f.onDOMReady(function(){(new k.BlockedImages()).init()})}(YAHOO));