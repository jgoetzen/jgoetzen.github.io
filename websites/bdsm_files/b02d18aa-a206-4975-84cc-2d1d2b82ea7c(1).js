// Copyright 2006-2017 ClickTale Ltd., US Patent Pending

window.ClickTaleGlobal = window.ClickTaleGlobal || {};
window.ClickTaleSettings = window.ClickTaleSettings || {};

ClickTaleGlobal.init = ClickTaleGlobal.init || {};
ClickTaleGlobal.scripts = ClickTaleGlobal.scripts || {};


ClickTaleGlobal.scripts.filter = ClickTaleGlobal.scripts.filter || (function () {
	var recordingThreshold = Math.random() * 100;

	return {
		isRecordingApproved: function(percentage) {
			return recordingThreshold <= percentage;
		}
	}
})();
	
		
// Copyright 2006-2017 ClickTale Ltd., US Patent Pending
// PID: 1020

var ctRules_PrePCC={"rules":"id|fa71d125-8fa2-40bf-b5ed-02f30c10721d|name|VE+Action+%7C+All+Pages+%7C+Clicked+on+Ask+a+Question|type|ClickEvent|title|Click+Event|isActive|action|CTEventAction|eventName|VE+Action+%7C+All+Pages+%7C+Clicked+on+Ask+a+Question|triggers|OrCondition|childConditions|ClickCondition|ctSelector|querySelector|#AnsAskQuestionMenuItem|alias|query-selector|states|LocationCondition|url|https://answers.microsoft.com/|mode|StartsWith|ignoreQueryString|41df7bda-bafa-4faa-b3ba-03db7fa9b1a0|VE+Action+%7C+All+Pages+%7C+Clicked+on+Get+more+info|Click+Event|VE+Action+%7C+All+Pages+%7C+Clicked+on+Get+more+info|#homeGetMoreInfo|3ed61647-3d7a-46aa-87ba-169e0b11053a|VE+Action+%7C+All+Pages+%7C+Clicked+on+Sign+in|Click+Event|VE+Action+%7C+All+Pages+%7C+Clicked+on+Sign+in|div.msame_Header.msame_unauth+div.x-hidden-focus|https://support.microsoft.com/en-us|AllPages|45e5ee07-6453-4c95-abcb-1c38f1301e98|VE+Action+%7C+All+Pages+%7C+Clicked+on+Support|Click+Event|VE+Action+%7C+All+Pages+%7C+Clicked+on+Support|#l1_support|a1fe0e45-ce5e-4e35-9766-282b6935ea8d|VE+Action+%7C+All+Pages+%7C+Interacted+with+Community+Top+Nav|Click+Event|VE+Action+%7C+All+Pages+%7C+Interacted+with+Community+Top+Nav|nav#uhf-c-nav+div+button|https://answers.microsoft.com|df562fc4-832b-41fb-8623-2a6996dfedc1|VE+Action+%7C+All+Pages+%7C+Clicked+on+Cart|Click+Event|VE+Action+%7C+All+Pages+%7C+Clicked+on+Cart|.glyph-shopping-cart|4f83980b-f9c5-4b80-9378-2e79d86bdfba|VE+Action+%7C+All+Pages+%7C+Clicked+on+any+category|Click+Event|VE+Action+%7C+All+Pages+%7C+Clicked+on+any+category|section[data-grid=\"container+stack-4\"]+div|ad2af6dc-d228-4baa-ba02-31f6dccc3a18|VE+Action+%7C+All+Pages+%7C+Interacted+with+Search+bar|Click+Event|VE+Action+%7C+All+Pages+%7C+Interacted+with+Search+bar|#search-text|e735d552-49f5-4f21-8615-337f639d79f3|VE+Action+%7C+All+Pages+%7C+Clicked+on+any+Get+more+Support+link|Click+Event|VE+Action+%7C+All+Pages+%7C+Clicked+on+any+Get+more+Support+link|#link-section-0+.landing-section-body+li+a|43f1de9e-5752-446c-a190-3d8eb46d64de|VE+Onload+%7C+<Page+name>|PageLoadEvent|Page+Event|dynamicEventName|parts|TextValue|VE+Onload+%7C|ElementValue|subType|InnerText|delimiter|+|PageLoadCondition|support.microsoft.com|Contains|answers.microsoft.com|Equals|563f476b-7ac5-4a5e-a6d8-47bcbbe6e399|VE+Action+%7C+All+Pages+%7C+Interacted+with+Search+field|Click+Event|VE+Action+%7C+All+Pages+%7C+Interacted+with+Search+field|#searchFormInputTxt|4e067dcf-3aba-4a7b-8958-5c49cb3154ce|VE+Action+%7C+All+Pages+%7C+Clicked+on+Microsoft+Top+Nav+sub-category|Click+Event|VE+Action+%7C+All+Pages+%7C+Clicked+on+Microsoft+Top+Nav+sub-category|.c-uhf-menu+>+ul+>+li+>+ul+>+li|.c-uhf-menu+>+ul+>+li|eb1269d2-4327-48d8-a5f5-67f45a39c107|VE+Action+%7C+All+Pages+%7C+Interacted+with+Microsoft+Top+Nav|Click+Event|VE+Action+%7C+All+Pages+%7C+Interacted+with+Microsoft+Top+Nav|#uhf-g-nav+>+ul+>+li+>+div+>+button|#uhf-g-nav+>+ul+>+li+>+a|16e16ece-6ba3-497e-9b3e-6804d06428e1|VE+Action+%7C+Clicked+on+Try+Virtual+Agent|Click+Event|VE+Action+%7C+Clicked+on+Try+Virtual+Agent|#skylight-entry-chrome|647cd158-e3de-42ae-896e-6f5d737e6dc6|VE+Action+%7C+All+Pages+%7C+Interacted+with+Home+Products+section|Click+Event|VE+Action+%7C+All+Pages+%7C+Interacted+with+Home+Products+section|#home-products-section+div+a|ca3e7072-b4fe-4ead-9e96-7423d19d07f0|VE+Action+%7C+All+Pages+%7C+Clicked+on+top+Username|Click+Event|VE+Action+%7C+All+Pages+%7C+Clicked+on+top+Username|.msame_Header|https://answers.microsoft.com/en-us|8b3b2f0d-fb23-4872-81ef-88a414f3f3ec|VE+Action+%7C+Clicked+on+View+all+Microsoft+products|Click+Event|VE+Action+%7C+Clicked+on+View+all+Microsoft+products|#all-products-link|126c3f65-4b6c-4e88-860e-afeabe84a4a4|VE+Action+%7C+All+Pages+%7C+Clicked+on+Quick+nav+-|Click+Event|VE+Action+%7C+All+Pages+%7C+Clicked+on+Quick+nav+-|.text-body.ng-binding|+|.container.quick-nav.ng-scope.home+div.row+div+a[target=\"_self\"]|b6d808d5-d23f-4125-bd79-b4f00868d7a7|VE+Action+%7C+All+Pages+%7C+Clicked+on+Community+Top+Nav+sub-category|Click+Event|VE+Action+%7C+All+Pages+%7C+Clicked+on+Community+Top+Nav+sub-category|nav#uhf-c-nav+div.c-uhf-menu.js-nav-menu+ul+li|e7b7cf9b-e38a-403f-9239-bbbcfb6661d9|VE+Action+%7C+All+Pages+%7C+Clicked+on+any+Setup+&+install+link|Click+Event|VE+Action+%7C+All+Pages+%7C+Clicked+on+any+Setup+&+install+link|#link-section-1+ul+li+a|119d5eea-dd37-4391-bd0d-c9731d2f9813|VE+Action+%7C+All+Pages+%7C+Clicked+on+any+Popular+topics+link|Click+Event|VE+Action+%7C+All+Pages+%7C+Clicked+on+any+Popular+topics+link|#link-section-2+ul+li+a|88d5246f-82f2-46ac-8476-d5cdca47adc7|VE+Onload+%7C+<Page+title>+%7C+<smc_f+cookie+value>|PageEventByElement|Page+Event+By+Component|VE+Onload+%7C|%7C|CookieValue|smc_f|+|DelayCondition|delay|AndCondition|support.microsoft.com/en-us|ExistsCondition|9c75d6d0-6ce7-4956-a233-d7d89149c2a9|VE+Action+%7C+All+Pages+%7C+Clicked+on+View+all+categories|Click+Event|VE+Action+%7C+All+Pages+%7C+Clicked+on+View+all+categories|#btnHomeCategoryShowAll^RS^^@$0|1|2|3|4|5|6|7|8|-1|9|$4|A|B|C]|D|$4|E|F|@$4|G|H|$I|J]|K|L]]]|M|$4|E|F|@$4|N|O|P|Q|R|S|-1]]]]|$0|T|2|U|4|5|6|V|8|-1|9|$4|A|B|W]|D|$4|E|F|@$4|G|H|$I|X]|K|L]]]|M|$4|E|F|@$4|N|O|P|Q|R|S|-1]]]]|$0|Y|2|Z|4|5|6|10|8|-1|9|$4|A|B|11]|D|$4|E|F|@$4|G|H|$I|12]|K|L]]]|M|$4|E|F|@$4|N|O|13|Q|14|S|-1]]]]|$0|15|2|16|4|5|6|17|8|-1|9|$4|A|B|18]|D|$4|E|F|@$4|G|H|$I|19]|K|L]]]|M|$4|N|O|13|Q|14|S|-1]]|$0|1A|2|1B|4|5|6|1C|8|-1|9|$4|A|B|1D]|D|$4|E|F|@$4|G|H|$I|1E]|K|L]]]|M|$4|E|F|@$4|N|O|1F|Q|R|S|-1]]]]|$0|1G|2|1H|4|5|6|1I|8|-1|9|$4|A|B|1J]|D|$4|E|F|@$4|G|H|$I|1K]|K|L]]]|M|$4|N|O|13|Q|14|S|-1]]|$0|1L|2|1M|4|5|6|1N|8|-1|9|$4|A|B|1O]|D|$4|E|F|@$4|G|H|$I|1P]|K|L]]]|M|$4|E|F|@$4|N|O|P|Q|R|S|-1]]]]|$0|1Q|2|1R|4|5|6|1S|8|-1|9|$4|A|B|1T]|D|$4|E|F|@$4|G|H|$I|1U]|K|L]]]|M|$4|E|F|@$4|N|O|13|Q|14|S|-1]]]]|$0|1V|2|1W|4|5|6|1X|8|-1|9|$4|A|B|1Y]|D|$4|E|F|@$4|G|H|$I|1Z]|K|L]]]|M|$4|N|O|13|Q|14|S|-1]]|$0|20|2|21|4|22|6|23|8|-1|9|$4|A|B|-4|24|$25|@$4|26|2|27]|$4|28|29|2A|H|$I|6]]]|2B|2C]]|D|$4|2D]|M|$4|E|F|@$4|N|O|2E|Q|2F|S|-1]|$4|N|O|2G|Q|2H|S|-1]]]]|$0|2I|2|2J|4|5|6|2K|8|-1|9|$4|A|B|2L]|D|$4|E|F|@$4|G|H|$I|2M]|K|L]]]|M|$4|E|F|@$4|N|O|P|Q|R|S|-1]]]]|$0|2N|2|2O|4|5|6|2P|8|-1|9|$4|A|B|2Q]|D|$4|E|F|@$4|G|H|$I|2R]|K|L]|$4|G|H|$I|2S]|K|L]]]|M|$4|E|F|@$4|N|O|13|Q|14|S|-1]]]]|$0|2T|2|2U|4|5|6|2V|8|-1|9|$4|A|B|2W]|D|$4|E|F|@$4|G|H|$I|2X]|K|L]|$4|G|H|$I|2Y]|K|L]]]|M|$4|E|F|@$4|N|O|13|Q|14|S|-1]]]]|$0|2Z|2|30|4|5|6|31|8|-1|9|$4|A|B|32]|D|$4|E|F|@$4|G|H|$I|33]|K|L]]]|M|$4|N|O|13|Q|14|S|-1]]|$0|34|2|35|4|5|6|36|8|-1|9|$4|A|B|37]|D|$4|E|F|@$4|G|H|$I|38]|K|L]]]|M|$4|N|O|13|Q|14|S|-1]]|$0|39|2|3A|4|5|6|3B|8|-1|9|$4|A|B|3C]|D|$4|E|F|@$4|G|H|$I|3D]|K|L]]]|M|$4|E|F|@$4|N|O|3E|Q|14|S|-1]]]]|$0|3F|2|3G|4|5|6|3H|8|-1|9|$4|A|B|3I]|D|$4|E|F|@$4|G|H|$I|3J]|K|L]]]|M|$4|N|O|13|Q|14|S|-1]]|$0|3K|2|3L|4|5|6|3M|8|-1|9|$4|A|B|-4|24|$25|@$4|26|2|3N]|$4|28|29|2A|H|$I|3O]]]|2B|3P]]|D|$4|E|F|@$4|G|H|$I|3Q]|K|L]]]|M|$4|N|O|13|Q|14|S|-1]]|$0|3R|2|3S|4|5|6|3T|8|-1|9|$4|A|B|3U]|D|$4|E|F|@$4|G|H|$I|3V]|K|L]]]|M|$4|E|F|@$4|N|O|1F|Q|R|S|-1]]]]|$0|3W|2|3X|4|5|6|3Y|8|-1|9|$4|A|B|3Z]|D|$4|E|F|@$4|G|H|$I|40]|K|L]]]|M|$4|N|O|13|Q|14|S|-1]]|$0|41|2|42|4|5|6|43|8|-1|9|$4|A|B|44]|D|$4|E|F|@$4|G|H|$I|45]|K|L]]]|M|$4|N|O|13|Q|14|S|-1]]|$0|46|2|47|4|48|6|49|8|-1|9|$4|A|B|-4|24|$25|@$4|26|2|4A]|$4|28|29|2A|H|$I|6]]|$4|26|2|4B]|$4|4C|2|4D]]|2B|4E]]|D|$4|4F|4G|4P]|M|$4|4H|F|@$4|E|F|@$4|N|O|4I|Q|2F|S|-1]]]|$4|4H|F|@$4|4J|K|L|29|-4|H|$I|6]]]]]]]|$0|4K|2|4L|4|5|6|4M|8|-1|9|$4|A|B|4N]|D|$4|E|F|@$4|G|H|$I|4O]|K|L]]]|M|$4|E|F|@$4|N|O|P|Q|R|S|-1]]]]]","isTransformed":true}; (function(){function CTSimplePromise(){var t=[],e=!1,n=void 0;this.resolve=function(o){if(!e){n=o,e=!0;for(var r=0;r<t.length;r++)t[r](o);t=[]}},this.then=function(o){e?o(n):t.push(o)}}function CTAnyPromise(t){for(var e=new CTSimplePromise,n=0;n<t.length;n++)t[n].then(function(t){e.resolve(t)});return e}function Rule(t){logger.log("Rule name: ",t.name),this.name=t.name;var e=actionsFactory.construct(t.action,t),n=observablesFactory.construct(t.triggers),o=statesFactory.construct(t.states);n&&n.subscribe(function(t){if(o.evaluate())return e.execute(t)})}function Observable(){this.subscribers=[]}function State(t){}function Action(t){}function ClickObservable(t){Observable.call(this);var e=this;ctSelectorUtils.bindEventHandler(clickHandlers,t,function(t){var n={domElement:t};e.notify(n)})}function onMouseDown(t){currentMouseDownElement=t.target||t.srcElement}function onMouseUp(t){var e=t.target||t.srcElement;if(e!=currentMouseDownElement)return void(currentMouseDownElement=null);for(var n in clickHandlers)if(clickHandlers.hasOwnProperty(n)){var o=clickHandlers[n][0].triggerData,r=ctSelectorUtils.getAncestorDomElement(o.ctSelector,e);null!=r&&clickHandlers[n].forEach(function(t){if("undefined"!=typeof o.value){var e={subType:o.subType,name:o.name},n=dynamicEventNameUtils.getDomElementContent(e,r);if(n!=o.value)return}t.callback.call(null,r)})}currentMouseDownElement=null}function DelayObservable(t){function e(){setTimeout(function(){n.notify()},t)}Observable.call(this);var n=this;onRulesBoundHandlers.push(e),CTLogicalPageEvent.subscribe(e)}function ElementDeclarationObservable(t){this.triggerData=t,Observable.call(this);var e=this;ctSelectorUtils.bindEventHandler(elementDeclarationHandlers,t,function(t){return logger.log("Element declaration event associated with selector: ",e.triggerData.ctSelector),e.notify()})}function OrObservable(t){Observable.call(this);var e=this;t.forEach(function(t){t.subscribe(function(t){return e.notify(t)})})}function PageLoadObservable(){function t(){logger.log("PageLoad event"),e.notify()}Observable.call(this);var e=this;onRulesBoundHandlers.push(t),CTLogicalPageEvent.subscribe(t)}function CTEventAction(t){this.actionData=t}function ElementCategoryAction(t){this.categoryId=t}function MultipleAction(t){this.children=t||[]}function TestRuleEventAction(t,e){this.actionData=t,this.ruleData=e}function DynamicEventNameAction(t,e){this.actionData=t,this.ruleData=e}function StaticEventNameAction(t,e){this.actionData=t,this.ruleData=e}function AndCondition(t){this.children=t}function CookieExistsState(t,e){this.cookieName=t,this.cookieValue=e}function ExistsState(t){this.stateData=t}function JSVariableExistsState(t,e){this.jsVariableName=t,this.jsVariableValue=e}function LocationState(t){logger.log("stateData: ",t),this.url=t.url.toLowerCase(),this.mode=t.mode,this.ignoreQueryString=t.ignoreQueryString}function NotCondition(t){this.childState=t}function OrCondition(t){this.children=t}function QSParamExistsState(t,e){this.queryStringParamName=t,this.queryStringParamValue=e}function UrlHashExistsState(t){this.urlHashValue=t}function init(){onDomReady(function(){if(startRulesEngine(),whenRecording(function(){ctRecordingPromise.resolve()}),window.ClickTaleMonitor&&ClickTaleMonitor.Settings){var t=window.ClickTaleMonitor.Settings.get();t.onReady(function(){ctMonitorReadyPromise.resolve()})}})}function whenRecording(t){if("undefined"!=typeof window.ClickTaleIsRecording&&window.ClickTaleIsRecording()===!0)t();else{var e=window.ClickTaleOnRecording;window.ClickTaleOnRecording=function(){t(),"undefined"!=typeof e&&"function"==typeof e&&e.apply(this,arguments)}}}function startRulesEngine(){try{if(!isSupportedBrowser())return;logger.log("startRulesEngine"),ct.ElementAddressing.bootstrap(window,!0),setTimeout(function(){buildRules()},300)}catch(t){logger.error("startRulesEngine error: ",t)}}function onDomReady(t){function e(){o||(o=!0,t())}function n(){if(!o)try{document.documentElement.doScroll("left"),e()}catch(t){setTimeout(n,10)}}var o=!1;if("complete"===document.readyState||"interactive"===document.readyState)return void e();if(document.addEventListener)document.addEventListener("DOMContentLoaded",e,!1);else if(document.attachEvent){try{var r=null!=window.frameElement}catch(i){}document.documentElement.doScroll&&!r&&n(),document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&e()})}if(window.addEventListener)window.addEventListener("load",e,!1);else if(window.attachEvent)window.attachEvent("onload",e);else{var a=window.onload;window.onload=function(){a&&a(),e()}}}function isIE(){var t=navigator.userAgent.toLowerCase();return t.indexOf("msie")!=-1&&parseInt(t.split("msie")[1])}function isSupportedBrowser(){try{return!isIE()||isIE()>9}catch(t){return logger.error("isSupportedBrowser: ",t),!1}}function buildRules(){if("undefined"!=typeof ctRules_PrePCC&&sessionStorage.getItem("CT_testRules")&&(ctRules_PrePCC=JSON.parse(sessionStorage.getItem("CT_testRules"))),"undefined"!=typeof ctRules_PrePCC&&logger.log("buildRules, rules:",ctRules_PrePCC),"undefined"!=typeof ctRules_PrePCC&&null!=ctRules_PrePCC){var t=null;t=ctRules_PrePCC.isTransformed?rulesEngine.jsonUnpacker.unpack(ctRules_PrePCC.rules):ctRules_PrePCC.rules,rules=t.map(function(t){return new Rule(t)})}onRulesBoundHandlers.forEach(function(t){t()})}Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),n=this,o=function(){},r=function(){return n.apply(this instanceof o?this:t,e.concat(Array.prototype.slice.call(arguments)))};return this.prototype&&(o.prototype=this.prototype),r.prototype=new o,r}),"function"!=typeof Object.create&&(Object.create=function(){function t(){}var e=Object.prototype.hasOwnProperty;return function(n){if("object"!=typeof n)throw TypeError("Object prototype may only be an Object or null");t.prototype=n;var o=new t;if(t.prototype=null,arguments.length>1){var r=Object(arguments[1]);for(var i in r)e.call(r,i)&&(o[i]=r[i])}return o}}());var logger=function(){function t(){var t=Array.prototype.slice.call(arguments);n&&(window.console&&window.console.log?(t.unshift((new Date).toJSON()+" - RuleEngine :"),window.console.log.apply(window.console,t)):window.alert&&window.alert(t.join(" ")))}for(var e={},n=!(!window.localStorage||"true"!==localStorage.getItem("ctRuleEngineDebug")),o=window.location.search.split("&"),r=[],i=0;i<o.length;i++)/^\??ctRuleEngine=/.test(o[i])&&r.push(o[i]);return r.length&&(n="true"===r[0].split("=").splice(1)[0],window.localStorage&&localStorage.setItem("ctRuleEngineDebug",n)),e.log=function(){t.apply(this,arguments)},e.error=function(e){t.apply(this,arguments)},e}();!function(){function t(t,e){var n=t.split("."),o=a;!(n[0]in o)&&o.execScript&&o.execScript("var "+n[0]);for(var r;n.length&&(r=n.shift());)n.length||void 0===e?o=o[r]?o[r]:o[r]={}:o[r]=e}function e(t,e){var n;if(t.map)n=t.map(e,void 0);else{n=[];for(var o=t.length,r=window,i=0;i<o;i++)n.push(e.call(r,t[i],i))}return n}function n(t,e){var n;if(t.filter)n=t.filter(e,void 0);else{n=[];for(var o=t.length,r=window,i=0;i<o;i++){var a=t[i];e.call(r,a,i)&&n.push(a)}}return n}if(!window.ct||!ct.ElementAddressing){var o=!0,r=null,i=!1,a=this,c={Z:{}},l=function(){var t=document.documentElement;return t.compareDocumentPosition||t.contains?function(t,e){var n=9===t.nodeType?t.documentElement:t;return t===e||n.contains&&n.contains(e)||t.compareDocumentPosition&&16&t.compareDocumentPosition(e)}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return o;return i}}(),s=Array.prototype.indexOf?function(t,e){return t.indexOf(e)}:function(t,e){for(var n=t.length,o=0;o<n;o++)if(t[o]===e)return o;return-1},u=Array.prototype.every?function(t,e){return t.every(e)}:function(t,e){for(var n=t.length,r=0;r<n;r++)if(!e(t[r]))return i;return o};c.version="3.0.23",c.p=i,c.h={},c.f={},c.A=function(t,e){e=!!e,c.j=t,/complete|interactive/.test(document.readyState)?c.m(t,e):t.document.addEventListener?t.document.addEventListener("DOMContentLoaded",function(){c.m(t,e)},i):document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&c.m(t,e)})},c.m=function(t,e){e&&c.z(c.f,t.document.documentElement),c.p=o},c.b=function(t){c.j.console&&c.debug&&c.j.console.log(t)},c.z=function(t,e){var n=e.firstChild;for(c.W(t,e);n;n=n.nextSibling)1===n.nodeType&&c.z(t,n)},c.V=function(t){return t in c.h&&c.h[t]},c.o=function(t,e){c.q(t).CustomID=e},c.O=function(t,e){c.o(t,e),c.f[e]=t},c.D=function(t,e){e in c.f?(c.h[e]=o,c.b("duplicate registration of custom id "+e+" were found on multiple elements")):(c.o(t,e),c.p&&(c.f[e]=t))},c.Q=c.d,c.d=function(t){return c.q(t).CustomID},c.q=function(t){var e=t.ClickTale;return e||(e={},t.ClickTale=e),e},c.W=function(t,e){var n=c.d(e);n&&(n in t?(c.h[n]=o,c.b("duplicate registration of custom id "+n+"were found on multiple elements")):t[n]=e)},c.H=function(t,n,o){var r=!(t[0]instanceof Array);return r&&(t=[t]),t=e(t,function(t){return c.I(t,n,o)}),r?t[0]:t},c.F=function(t,n){var o=!(t[0]instanceof Array);o&&(t=[t]);var r=e(t,function(t){return c.K(t,n)});return o?r[0]:r},c.I=function(t,e,n){return t=c.r(e,t),t.a&&0<t.e.length&&(t.a=c.l(t.e,t.a)),!n&&t.a&&c.v(t.a)?r:t.a},c.K=function(t,e){var n=c.r(e,t);if(n.a&&0<n.e.length&&(n.a=c.l(n.e,n.a)),n.a){var o={};return o.dom=n.a,o.isHidden=c.v(n.a),o}return r},c.v=function(t){return"hidden"===c.t(t).visibility.toLowerCase()},c.t=function(t){return c.j.getComputedStyle?c.j.getComputedStyle(t,r):t.currentStyle},c.G=function(t){return c.f[t]},c.J=function(t){return!!c.d(t)},c.$=function(t,e){return c.d(t)===e},c.n={},c.i=function(t){return c.n[t]||(c.n[t]=c.B(t)),c.n[t]},c.B=function(t){return(t.charCodeAt(0)-64&31)+((t.charCodeAt(1)-64&28)<<3)+((t.charCodeAt(2)-64&30)<<7)},c.k=function(t){return(t.charCodeAt(0)-64&7)+((t.charCodeAt(0)-64&16)>>1)+((t.charCodeAt(1)-64&4)<<2)+((t.charCodeAt(3)-64&4)<<3)},c.u=function(t,e){var n=e.elementID,o=e.customID,r=c.c(t,"id"),i=c.d(t);return!c.g([o,i])&&o!==i||!c.g([n,r])&&n!==r},c.X=function(t,e){var n=e.name,o=c.c(t,"name");return c.d(t),!c.g([n,o])&&n!==o},c.l=function(t,e,n){var a,l=0,s=r;a=i;for(var u=r,d=r,f=t.length,p=0;e&&p<f;p++){for(a=i,d=t[p],s=e.firstChild,l=0;!a&&s;s=s.nextSibling)if(1===s.nodeType&&c.i(s.tagName)===d.tagCode){if(l===d.index){if(u=s,!n&&(c.u(u,d)||c.X(u,d)))return r;if(e=d.typeCode,a=c.c(u,"type"),!c.g([e,a])&&a&&e!=c.k(a))return r;a=o,e=u}l++}if(a===i)return r}return(a=a&&"none"!==c.t(e).display.toLowerCase())?e:r},c.c=function(t,e){var n=t.getAttributeNode(e);return n?n.value:r},c.g=function(t){return u(t,function(t){return!t})},c.s=function(t,e){var n=e.customID;return n?c.L(n):c.M(t,e.elementID)},c.L=function(t){var e;return c.V(t)?c.b("duplicate custom id "+t+" were found on multiple elements"):e=c.G(t),e},c.M=function(t,e){var n,o;return e?(o=c.P(t,e),o&&0!==o.length?1===o.length?(n=o[0],c.J(n)?r:n):(c.b("duplicate id "+e+" were found on multiple elements."),n):(c.b("no element with id "+e+" was found."),n)):n},c.P=function(t,e){var n;try{n=t.querySelectorAll("#"+e),n.length||(n=t.querySelectorAll("[id='"+e.replace(/'/g,"\\'")+"']"))}catch(o){n=t.querySelectorAll("[id='"+e.replace(/'/g,"\\'")+"']")}return n},c.r=function(t,e){for(var n,o,i,a=e.length,l=a,s={},u=t.ownerDocument;0<l;l--)if(i=e[l-1],o=c.s(u,i),!o&&(n=i.name)&&l===a&&(o=c.S(u,n,e,l))&&c.u(o,i)&&(o=r),o)return n=e.slice(l,a),s.e=n,s.a=o,s;return s.e=e,s.a=t,s},c.S=function(t,e,n,o){var i,a=r,o=n.slice(0,o-1);return(i=c.T(t,o))?a=c.N(t,e,i,n):c.b("could not resolve form. form doesn't have an anchor."),a},c.N=function(t,e,o,r){var i,t=t.getElementsByName(e);if(1<t.length){if(t=n(t,function(t){return c.w(o,t)}),c.C(t))return e=r[r.length-1].index,c.R(t,e);c.b("duplicate name "+e+" found on multiple non radio elements.")}else 1===t.length&&(r=t[0],c.w(o,r)?i=r:c.b("could not resolve nested element with name "+e+" in form."));return i},c.R=function(t,e){for(var n,a,c,l=[],u=i,d=0;d<t.length;d++)if(c=t[d],a=c.parentNode,-1===s(l,a)&&(l.push(a),a=a.getElementsByTagName(c.tagName),a.length-1>=e)){if(u)return r;n=a[e],u=o}return n},c.C=function(t){for(var e=0;e<t.length;e++)if(!c.U(t[e]))return i;return o},c.U=function(t){return t=c.c(t,"type"),!!t&&"radio"===t.toLowerCase()},c.w=function(t,e){return l(t,e)},c.T=function(t,e){for(var n,o=e.length;0<o;o--)if(n=e[o-1],(n=c.s(t,n))&&1===n.nodeType&&"form"===n.tagName.toLowerCase())return n;return r},c.Y=function(t,e){var n,o=0,i=0,a=r,l=[],s=t;if(!e)return c.b("Base element was not specified"),l;for(;s&&s!==e;)if(1!==s.nodeType)s=s.parentNode;else{for(i=0,a={},t=s,o=c.i(s.nodeName),a.tagCode=o,(n=c.d(t))&&(a.customID=n),(n=c.c(t,"id"))&&(a.elementID=n),(n=c.c(t,"name"))&&(a.name=n),(n=c.c(t,"type"))&&(a.typeCode=c.k(n)),n=s;n=n.previousSibling;)c.i(n.nodeName)===o&&i++;a.index=i,s=s.parentNode,l.push(a)}return l.reverse(),l},t("ct.ElementAddressing.bootstrap",c.A),t("ct.ElementAddressing.elementFromPath",c.H),t("ct.ElementAddressing.pathFromElement",c.Y),t("ct.ElementAddressing.elementAndVisibilityFromPath",c.F),t("ct.ElementAddressing.setCustomElementID",c.D),t("ct.ElementAddressing.getCustomElementID",c.Q),t("ct.ElementAddressing.forceSetCustomElementID",c.O),t("ct.ElementAddressing.calcTagCode",c.i),t("ct.ElementAddressing.calcTypeCode",c.k),t("ct.ElementAddressing.findByPath",c.l),t("ct.ElementAddressing.version",c.version)}}();var ctRecordingPromise=new CTSimplePromise,ctMonitorReadyPromise=new CTSimplePromise,ctAnyRecorderReadyPromise=new CTAnyPromise([ctRecordingPromise,ctMonitorReadyPromise]),CTLogicalPageEvent=function(){function t(){setTimeout(function(){for(var t=0;t<e.length;t++)e[t]()},250)}var e=[];return ctAnyRecorderReadyPromise.then(function(){if(window.ClickTaleMonitor){var e=window.ClickTaleMonitor.restart;ClickTaleMonitor.restart=function(){"function"==typeof e&&e.apply(this,arguments),t()}}else{var e=window.ClickTaleLogical;window.ClickTaleLogical=function(){"function"==typeof e&&e.apply(this,arguments),t()}}}),{subscribe:function(t){e.push(t)}}}(),exports={},rulesEngine=exports;Observable.prototype.subscribe=function(t){this.subscribers.push(t)},Observable.prototype.notify=function(t){var e,n=this;return n.subscribers.forEach(function(n){var o=n(t);null!=o&&(e=o)}),e};var observablesFactory={construct:function(t){return null==t?null:this["construct"+t.type.replace("Condition","")](t)}};State.prototype.evaluate=function(t){};var statesFactory={construct:function(t){return this["construct"+t.type.replace("Condition","")](t)}},actionsFactory={construct:function(t,e){return this["construct"+t.type.replace("Action","")](t,e)}};Action.prototype.execute=function(t){};var ctSelectorUtils=function(){function t(t){var e=[];if(t.elementAddressing){var n=ct.ElementAddressing.elementFromPath(t.elementAddressing,document.body,!0);n&&e.push(n)}else if(t.querySelector)try{e=Array.prototype.slice.call(document.querySelectorAll(t.querySelector))}catch(o){}return e}function e(t){switch(Object.keys(t)[0]){case"elementAddressing":return JSON.stringify(t.elementAddressing);case"querySelector":return t.querySelector}}function n(t,e){var n,o=t.length;for(n=0;n<o;n+=1)if(t[n]===e)return!0;return!1}var o={};return o.bindEventHandler=function(t,n,o){var r=e(n.ctSelector);t[r]=t[r]||[],t[r].push({callback:o,triggerData:n})},o.isAncestor=function(t,e){var n=o.getAncestorDomElement(t,e);return null!=n},o.getAncestorDomElement=function(t,e){for(var r=!1,i=e,a=o.getDOMelements(t);!r&&"HTML"!==i.tagName&&i.parentElement;)r=n(a,i),r||(i=i.parentElement);return r?i:null},o.getDOMelements=function(e){if(Array.isArray(e)){var n=[];return e.forEach(function(e){n=n.concat(t(e))}),n}return t(e)},o.getFirstDOMelement=function(e){if(e&&null!=e){var n=t(e);if(null!=n&&n.length>0)return n[0]}return null},o}();ClickObservable.prototype=Object.create(Observable.prototype),ClickObservable.prototype.constructor=ClickObservable,observablesFactory.constructClick=function(t){return new ClickObservable(t)},document.addEventListener&&(document.addEventListener("mousedown",onMouseDown,!1),document.addEventListener("mouseup",onMouseUp,!1));var clickHandlers={},currentMouseDownElement=null;DelayObservable.prototype=Object.create(Observable.prototype),DelayObservable.prototype.constructor=DelayObservable,observablesFactory.constructDelay=function(t){return new DelayObservable(t.delay)};var elementDeclarationHandlers={};ElementDeclarationObservable.prototype=Object.create(Observable.prototype),ElementDeclarationObservable.prototype.constructor=ElementDeclarationObservable,observablesFactory.constructElementDeclaration=function(t){return new ElementDeclarationObservable(t)},window.ClickTaleSettings=window.ClickTaleSettings||{},window.ClickTaleSettings.AugmentElementPath=function(t){var e;for(var n in elementDeclarationHandlers)if(elementDeclarationHandlers.hasOwnProperty(n)){var o=elementDeclarationHandlers[n][0].triggerData,r=ctSelectorUtils.getAncestorDomElement(o.ctSelector,t);null!=r&&elementDeclarationHandlers[n].forEach(function(n){if("undefined"!=typeof o.value){var i={subType:o.subType,name:o.name},a=dynamicEventNameUtils.getDomElementContent(i,r);if(a!=o.value)return}e=n.callback.call(null,t)||e})}return null!=e?{type:"pathdata",data:{categoryid:e}}:null},OrObservable.prototype=Object.create(Observable.prototype),OrObservable.prototype.constructor=OrObservable,observablesFactory.constructOr=function(t){var e=t.childConditions.map(function(t){return observablesFactory.construct(t)});return new OrObservable(e)},PageLoadObservable.prototype=Object.create(Observable.prototype),PageLoadObservable.prototype.constructor=PageLoadObservable,observablesFactory.constructPageLoad=function(){return new PageLoadObservable};var dynamicEventNameUtils=function(){var t={};t.getDynamicEventName=function(t,r){var s="";if(t&&t.parts&&t.parts.length>0){for(var u="undefined"!=typeof t.delimiter?t.delimiter:" ",d=0;d<t.parts.length;d++){var f=t.parts[d],p="";try{switch(f.type){case"TextValue":p=f.name;break;case"ElementValue":p=e(f);break;case"TriggeredElementValue":"undefined"!=typeof r&&null!=r&&(p=n(f,r));break;case"CookieValue":p=c(f.name);break;case"JSVariableValue":p=o(f.name);break;case"QueryStringParamName":p=l(f.name);break;case"BookmarkName":p=a();break;case"URLValue":p=i()}null==p&&(p="")}catch(m){"undefined"!=typeof logger&&logger.error("getDynamicEventName: ",m)}s+=u+p}s.length>0&&(s=s.substring(u.length))}return s};var e=function(t){var e=ctSelectorUtils.getFirstDOMelement(t.ctSelector);return null!=e?n(t,e):""},n=function(t,e){var n=t.subType;switch(n){case"Attribute":var o=t.name,r=e.getAttribute(o);return null!=r?r:e[o];case"AllInnerText":return u(e).join(" ");case"InnerText":default:return"undefined"!=typeof e.firstChild&&null!=e.firstChild?"function"==typeof e.firstChild.nodeValue.trim?e.firstChild.nodeValue.trim():e.firstChild.nodeValue:"undefined"!=typeof e.value&&null!=e.value?"function"==typeof e.value.trim?e.value.trim():e.value:""}};t.getDomElementContent=function(t,e){return n(t,e)};var o=function(t){for(var e=t.split("."),n=window[e[0]],o=1;o<e.length;o++)n=n[e[o]];return r(n)};t.getJSVariable=function(t){return o(t)};var r=function(t){return t="undefined"==typeof t||"object"==typeof t?null:t.toString()},i=function(t){return t||(t="-"),window.location.pathname.split("/").join(t).substring(1)},a=function(){return window.location.hash?window.location.hash.split("#")[1]:null},c=function(t){for(var e=t+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var r=n[o];" "==r.charAt(0);)r=r.substring(1);if(0==r.indexOf(e))return r.substring(e.length,r.length)}return""};t.getCookieValue=function(t){return c(t)};var l=function(t,e){e||(e=window.location.href),t=t.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)"),o=n.exec(e);return o?o[2]?decodeURIComponent(o[2].replace(/\+/g," ")):"":null};t.getQueryStringParameterValue=function(t){return l(t)};var s=function(t,e){for(e(t),t=t.firstChild;t;)s(t,e),t=t.nextSibling},u=function(t){function e(t){switch(t.nodeType){case 1:"undefined"!=typeof t.value&&null!=t.value&&n.push("function"==typeof t.value.trim?t.value.trim():t.value);break;case 3:"undefined"!=typeof t.nodeValue&&null!=t.nodeValue&&n.push("function"==typeof t.nodeValue.trim?t.nodeValue.trim():t.nodeValue)}}"string"==typeof t&&(t=document.getElementById(t));var n=[];return s(t,e),n};return t}();CTEventAction.prototype=Object.create(Action.prototype),CTEventAction.prototype.constructor=Action,CTEventAction.prototype.execute=function(t){var e=this;ctRecordingPromise.then(function(){if("function"==typeof window.ClickTaleIsRecording&&window.ClickTaleIsRecording())if("function"==typeof window.ClickTaleEvent){var n;t&&(n=t.domElement);var o=e.geEventName(n);""!=o&&(window.ClickTaleEvent(o),logger.log("CT-Core ClickTaleEvent: "+o))}else logger.log("window.ClickTaleEvent not exists");else logger.log("window.ClickTaleIsRecording not exists or recording is not active")})},CTEventAction.prototype.geEventName=function(t){return this.actionData.dynamicEventName?dynamicEventNameUtils.getDynamicEventName(this.actionData.dynamicEventName,t):this.actionData.eventName},actionsFactory.constructCTEvent=function(t){return new CTEventAction(t)},ElementCategoryAction.prototype=Object.create(Action.prototype),ElementCategoryAction.prototype.constructor=Action,ElementCategoryAction.prototype.execute=function(){return this.categoryId},actionsFactory.constructElementCategory=function(t){return new ElementCategoryAction(t.categoryId)},MultipleAction.prototype=Object.create(Action.prototype),MultipleAction.prototype.constructor=Action,MultipleAction.prototype.execute=function(t){this.children.forEach(function(e){e.execute(t)}),logger.log("Executing Multiple Action")},actionsFactory.constructMultiple=function(t,e){var n=this;n.ruleData=e;var o=t.children.map(function(t){return actionsFactory.construct(t,n.ruleData)});return new MultipleAction(o)},TestRuleEventAction.prototype=Object.create(Action.prototype),TestRuleEventAction.prototype.constructor=Action,TestRuleEventAction.prototype.execute=function(t){var e=this;e.triggeredDomElement="undefined"!=typeof t?t.domElement:null;var n=e.geParams();window.ct_ve_parent_window&&window.ct_ve_parent_window.postMessage({name:"testRuleEvent",params:n},"*")},TestRuleEventAction.prototype.geParams=function(){var t={testTime:(new Date).getTime(),clickletId:this.ruleData.id,clickletName:this.ruleData.name,clickletType:this.ruleData.title,isActive:this.ruleData.isActive,platform:this.gePlatform(),data:this.geData(),eventNameMode:this.getEventNameMode()};return t},TestRuleEventAction.prototype.gePlatform=function(){var t=this.actionData.actualType;return"StaticEventNameAction"==t||"DynamicEventNameAction"==t?"CEC":"Core"},TestRuleEventAction.prototype.getEventNameMode=function(){var t=this.actionData.dynamicEventName;return"undefined"!=typeof t&&null!=t?"Dynamic":"Static"},TestRuleEventAction.prototype.geData=function(){var t=null;switch(this.actionData.actualType){case"CTEventAction":t=this.geEventName();break;case"StaticEventNameAction":t=this.geEventName()+" [eventId:"+this.actionData.eventId+"]";break;case"DynamicEventNameAction":var e=3;"ClickEvent"==this.ruleData.type&&(e=4),t=this.geEventName()+" [eventId: "+this.actionData.eventId+", type: "+e+"]";break;case"ElementCategoryAction":t=this.actionData.categoryName+" ["+this.actionData.categoryId+"]"}return t},TestRuleEventAction.prototype.geEventName=function(){return this.actionData.dynamicEventName?dynamicEventNameUtils.getDynamicEventName(this.actionData.dynamicEventName,this.triggeredDomElement):this.actionData.eventName},actionsFactory.constructTestRuleEvent=function(t,e){return new TestRuleEventAction(t,e)},DynamicEventNameAction.prototype=Object.create(Action.prototype),DynamicEventNameAction.prototype.constructor=Action,DynamicEventNameAction.prototype.execute=function(t){var e=this;try{if(window.ClickTaleMonitor&&"function"==typeof window.ClickTaleMonitor.isMonitoring&&window.ClickTaleMonitor.isMonitoring()){e.triggeredDomElement="undefined"!=typeof t?t.domElement:null;var n=e.geEventName();if(""!=n)switch(this.ruleData.type){case"ClickEvent":if("function"==typeof window.ClickTaleMonitor.addDynamicAction)try{window.ClickTaleMonitor.addDynamicAction(this.actionData.eventId,n),logger.log("CEC ClickTaleEvent - ","eventName: ",n,", eventId: ",this.actionData.eventId)}catch(o){logger.log("CEC ClickTaleEvent - window.ClickTaleMonitor.addDynamicAction throws exception")}else logger.log("CEC ClickTaleEvent - window.ClickTaleMonitor.addDynamicAction not exists");break;case"PageEventByElement":case"PageLoadEvent":if("function"==typeof window.ClickTaleMonitor.addPageTag)try{window.ClickTaleMonitor.addPageTag(this.actionData.eventId,n),logger.log("CEC ClickTaleEvent - ","eventName: ",n,", eventId: ",this.actionData.eventId)}catch(o){logger.log("CEC ClickTaleEvent - window.ClickTaleMonitor.addPageTag throws exception")}else logger.log("CEC ClickTaleEvent - window.ClickTaleMonitor.addPageTag not exists")}else logger.log("CEC ClickTaleEvent - event name is empty for eventId: ",this.actionData.eventId)}else logger.log("CEC ClickTaleEvent - window.ClickTaleMonitor.isMonitoring not exists or monitoring is not active")}catch(o){}},DynamicEventNameAction.prototype.geEventName=function(){return this.actionData.dynamicEventName?dynamicEventNameUtils.getDynamicEventName(this.actionData.dynamicEventName,this.triggeredDomElement):this.actionData.eventName},actionsFactory.constructDynamicEventName=function(t,e){return new DynamicEventNameAction(t,e)},StaticEventNameAction.prototype=Object.create(Action.prototype),StaticEventNameAction.prototype.constructor=Action,StaticEventNameAction.prototype.execute=function(){try{window.ClickTaleMonitor&&"function"==typeof window.ClickTaleMonitor.isMonitoring&&window.ClickTaleMonitor.isMonitoring()?"function"==typeof window.ClickTaleMonitor.addEvent?(window.ClickTaleMonitor.addEvent(this.actionData.eventId),logger.log("CEC ClickTaleEvent - eventId: ",this.actionData.eventId)):logger.log("CEC ClickTaleEvent - window.ClickTaleMonitor.addEvent not exists"):logger.log("CEC ClickTaleEvent - window.ClickTaleMonitor.isMonitoring not exists or monitoring is not active")}catch(t){}},actionsFactory.constructStaticEventName=function(t,e){return new StaticEventNameAction(t,e)},AndCondition.prototype=Object.create(State.prototype),AndCondition.prototype.constructor=AndCondition,AndCondition.prototype.evaluate=function(){for(var t=0;t<this.children.length;t++){var e=this.children[t].evaluate();if(0==e)return!1}return!0},statesFactory.constructAnd=function(t){var e=t.childConditions.map(function(t){return statesFactory.construct(t)});return new AndCondition(e)},CookieExistsState.prototype=Object.create(State.prototype),CookieExistsState.prototype.constructor=CookieExistsState,CookieExistsState.prototype.evaluate=function(){for(var t=!1,e=document.cookie.split(";"),n=0;n<e.length;n++)if(e[n].split("=")[0].trim()==this.cookieName){t=!0;break}return!!t&&(void 0==this.cookieValue||this.cookieValue==dynamicEventNameUtils.getCookieValue(this.cookieName))},statesFactory.constructCookieExists=function(t){return new CookieExistsState(t.name,t.value)},ExistsState.prototype=Object.create(State.prototype),ExistsState.prototype.constructor=ExistsState,ExistsState.prototype.evaluate=function(){var t=this,e=ctSelectorUtils.getDOMelements(t.stateData.ctSelector);return"undefined"!=typeof t.stateData.value?e.some(function(e){var n={subType:t.stateData.subType,name:t.stateData.name},o=dynamicEventNameUtils.getDomElementContent(n,e);return o==t.stateData.value}):e.length>0},statesFactory.constructExists=function(t){return new ExistsState(t)},JSVariableExistsState.prototype=Object.create(State.prototype),JSVariableExistsState.prototype.constructor=JSVariableExistsState,JSVariableExistsState.prototype.evaluate=function(){try{for(var t=this.jsVariableName.split("."),e=window[t[0]],n=1;n<t.length;n++)e=e[t[n]]}catch(o){}return"undefined"!=typeof e&&("undefined"==typeof this.jsVariableValue||(null===e&&(e="null"),e==this.jsVariableValue||e.toString()==this.jsVariableValue))},statesFactory.constructJSVariableExists=function(t){return new JSVariableExistsState(t.name,t.value)},LocationState.prototype=Object.create(State.prototype),LocationState.prototype.constructor=State,LocationState.prototype.evaluate=function(t){var e=t||window.location.href;switch(e=e.toLowerCase(),this.ignoreQueryString===!0&&(e=e.split(/[?#]/)[0],this.url=this.url.split(/[?#]/)[0]),this.mode){case"AllPages":return!0;case"StartsWith":return 0==e.indexOf(this.url);case"EndsWith":return e.lastIndexOf(this.url)>=0;case"Equals":return e===this.url;case"Contains":return e.indexOf(this.url)>=0;case"NotStartsWith":return 0!=e.indexOf(this.url);case"NotEndsWith":return e.lastIndexOf(this.url)<0;case"NotEquals":return e!=this.url;case"NotContains":return e.indexOf(this.url)<0}},statesFactory.constructLocation=function(t){return new LocationState(t)},NotCondition.prototype=Object.create(State.prototype),NotCondition.prototype.constructor=NotCondition,NotCondition.prototype.evaluate=function(){return!this.childState.evaluate()},statesFactory.constructNot=function(t){var e=statesFactory.construct(t.condition);return new NotCondition(e)},OrCondition.prototype=Object.create(State.prototype),OrCondition.prototype.constructor=OrCondition,OrCondition.prototype.evaluate=function(){for(var t=0;t<this.children.length;t++){var e=this.children[t].evaluate();if(1==e)return!0}return!1},statesFactory.constructOr=function(t){var e=t.childConditions.map(function(t){return statesFactory.construct(t)});return new OrCondition(e)},QSParamExistsState.prototype=Object.create(State.prototype),QSParamExistsState.prototype.constructor=QSParamExistsState,QSParamExistsState.prototype.evaluate=function(){for(var t=!1,e=window.location.search.substring(1).split("&"),n=0;n<e.length;n++)if(e[n].split("=")[0]==this.queryStringParamName){t=!0;break}return!!t&&(void 0==this.queryStringParamValue||this.queryStringParamValue==dynamicEventNameUtils.getQueryStringParameterValue(this.queryStringParamName))},statesFactory.constructQSParamExists=function(t){return new QSParamExistsState(t.name,t.value)},UrlHashExistsState.prototype=Object.create(State.prototype),UrlHashExistsState.prototype.constructor=UrlHashExistsState,UrlHashExistsState.prototype.evaluate=function(){return window.location.hash.split("#")[1]==this.urlHashValue},statesFactory.constructUrlHashExists=function(t){return new UrlHashExistsState(t.name)},function(t){var e=-1,n=-2,o=-3,r=-4,i=-5,a=function(t){var a=t.split("^"),s=[],u=a[0];if(""!==u){u=u.split("|");for(var d=0,f=u.length;d<f;d++)s.push(c(u[d]))}if(u=a[1],""!==u){u=u.split("|");for(var d=0,f=u.length;d<f;d++)s.push(l(u[d]))}if(u=a[2],""!==u){u=u.split("|");for(var d=0,f=u.length;d<f;d++)s.push(parseFloat(u[d]))}delete u;for(var p="",m=[],v=a[3].length,d=0;d<v;d++){var g=a[3].charAt(d);"|"===g||"$"===g||"@"===g||"]"===g?(p&&(m.push(l(p)),p=""),"|"!==g&&m.push(g)):p+=g}var y=m.length,h=0;return function E(){var t=m[h++];if("@"===t){for(var a=[];h<y;h++){var c=m[h];if("]"===c)return a;if("@"===c||"$"===c)a.push(E());else switch(c){case e:a.push(!0);break;case n:a.push(!1);break;case o:a.push(null);break;case i:a.push(void 0);break;case r:a.push("");break;default:a.push(s[c])}}return a}if("$"===t){for(var a={};h<y;h++){var l=m[h];if("]"===l)return a;l=l===r?"":s[l];var c=m[++h];if("@"===c||"$"===c)a[l]=E();else switch(c){case e:a[l]=!0;break;case n:a[l]=!1;break;case o:a[l]=null;break;case i:a[l]=void 0;break;case r:a[l]="";break;default:a[l]=s[c]}}return a}throw new TypeError("Bad token "+t+" isn't a type")}()},c=function(t){return"string"!=typeof t?t:t.replace(/\+|%2B|%7C|%5E|%25/g,function(t){return{"+":" ","%2B":"+","%7C":"|","%5E":"^","%25":"%"}[t]})},l=function(t){return parseInt(t,36)};t.jsonUnpacker={unpack:function(t){
return a(t)}}}(exports);var rules,onRulesBoundHandlers=[];init();}());

/*browsers exclusion start*/function doOnlyWhen(toDoHandler, toCheckHandler, interval, times, failHandler) {
    if ((!toDoHandler) || (!toCheckHandler)) return;
    if (typeof interval == "undefined") interval = 1000;
    if (typeof times == "undefined") times = 20;

    if (--times < 0 && typeof failHandler === 'function') {
        failHandler();
        return;
    }
    if (toCheckHandler()) {
        toDoHandler();
        return;
    }

    setTimeout(function () { doOnlyWhen(toDoHandler, toCheckHandler, interval, times); }, interval);
}
doOnlyWhen(function () { if (window.ClickTaleSettings.PTC.okToRunPCC) { (function(){
window.ClickTaleSettings = window.ClickTaleSettings || {};
window.ClickTaleSettings.PTC = window.ClickTaleSettings.PTC || {};
window.ClickTaleSettings.PTC.originalPCCLocation = "P32_PID1020";
var e=!0,g=null,l=!1;function m(){return function(){}}var n=this;var o,p,q,r;function aa(){return n.navigator?n.navigator.userAgent:g}r=q=p=o=l;var s;if(s=aa()){var ba=n.navigator;o=0==s.indexOf("Opera");p=!o&&-1!=s.indexOf("MSIE");q=!o&&-1!=s.indexOf("WebKit");r=!o&&!q&&"Gecko"==ba.product}var ca=o,t=p,u=r,v=q,w;
a:{var x="",y;if(ca&&n.opera)var z=n.opera.version,x="function"==typeof z?z():z;else if(u?y=/rv\:([^\);]+)(\)|;)/:t?y=/MSIE\s+([^\);]+)(\)|;)/:v&&(y=/WebKit\/(\S+)/),y)var da=y.exec(aa()),x=da?da[1]:"";if(t){var A,ea=n.document;A=ea?ea.documentMode:void 0;if(A>parseFloat(x)){w=""+A;break a}}w=x}var fa={};
function B(a){var b;if(!(b=fa[a])){b=0;for(var c=(""+w).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=(""+a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),f=Math.max(c.length,d.length),h=0;0==b&&h<f;h++){var i=c[h]||"",G=d[h]||"",Ia=RegExp("(\\d*)(\\D*)","g"),Ja=RegExp("(\\d*)(\\D*)","g");do{var k=Ia.exec(i)||["","",""],j=Ja.exec(G)||["","",""];if(0==k[0].length&&0==j[0].length)break;b=((0==k[1].length?0:parseInt(k[1],10))<(0==j[1].length?0:parseInt(j[1],10))?-1:(0==k[1].length?0:parseInt(k[1],
10))>(0==j[1].length?0:parseInt(j[1],10))?1:0)||((0==k[2].length)<(0==j[2].length)?-1:(0==k[2].length)>(0==j[2].length)?1:0)||(k[2]<j[2]?-1:k[2]>j[2]?1:0)}while(0==b)}b=fa[a]=0<=b}return b}var ga={};function ha(){ga[9]||(ga[9]=t&&!!document.documentMode&&9<=document.documentMode)};!t||ha();!t||ha();t&&B("8");!v||B("528");u&&B("1.9b")||t&&B("8")||ca&&B("9.5")||v&&B("528");!u||B("8");var ia;function C(a,b,c,d,f){a&&b&&("undefined"==typeof c&&(c=1E3),"undefined"==typeof d&&(d=20),0>--d?"function"===typeof f&&f():b()?a():setTimeout(function(){C(a,b,c,d,f)},c))}function ja(a){var b="someText".trim,c=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;ia=b&&!b.call(new String("\ufeff\u00a0"))?function(a){return a==g?"":b.call(a)}:function(a){return a==g?"":(a+"").replace(c,"")};return ia(a)};function D(a,b){if(a&&a.nodeType&&9===a.nodeType)return l;var c=Element.prototype;D=function(a,b){return!a||!document.documentElement.contains(a)?l:D.e.call(a,b)};D.e=c.matches||c.webkitMatchesSelector||c.mozMatchesSelector||c.msMatchesSelector;return D(a,b)}function E(a,b){E=Element.prototype.closest?function(a,b){return!(a&&a instanceof Element)?g:Element.prototype.closest.call(a,b)}:function(a,b){for(;a&&!D(a,b);)a=a.parentElement;return a};return E(a,b)};var ka=l,la=Object.defineProperty&&Object.defineProperty({},"passive",{get:function(){ka=e}});document.addEventListener("test",m(),la);var F=ka?{passive:e,capture:e}:e,ma=0;function H(a){function b(){2==++H.f&&a()}na(b);if("function"==typeof ClickTaleIsRecording&&ClickTaleIsRecording()===e)b();else{var c=window.ClickTaleOnRecording||m();window.ClickTaleOnRecording=function(){b();return c.apply(this,arguments)}}}H.f=0;
function na(a){function b(){c||(c=e,a())}var c=l;"loading"!=document.readyState?b():document.addEventListener&&document.addEventListener("DOMContentLoaded",b,l)}
function I(a,b,c,d,f){"string"===typeof a?(a=document.querySelectorAll(a),Array.prototype.forEach.call(a,function(a){I(a,b,c,d,f)})):a instanceof Array||a instanceof NodeList?Array.prototype.forEach.call(a,function(a){I(a,b,c,d,f)}):a.addEventListener(b,function(a,b,c,d,f){return function(k){if("function"===typeof c)c.apply(this,arguments),f&&a.removeEventListener(b,arguments.callee,F);else{var j=E(k.target,c);j&&a.compareDocumentPosition(j)&Node.DOCUMENT_POSITION_CONTAINED_BY&&(d.apply(j,arguments),
f&&a.removeEventListener(b,arguments.callee,F))}}}(a,b,c,d,f),F)}function oa(a,b){document.addEventListener("mouseup",function(c){a===c.target&&b();document.removeEventListener("mouseup",arguments.callee,F)},e)}
function pa(a,b){function c(c){document.removeEventListener("touchend",arguments.callee,F);a===c.target&&b()}document.addEventListener("touchend",c,F);document.addEventListener("touchmove",function(a){document.removeEventListener("touchmove",arguments.callee,F);document.removeEventListener("touchend",c,F)},F)}function J(a,b){var c=K();c&&(J=c.m?pa:oa,J(a,b))}
function L(a,b){if("string"===typeof a){var c=document.querySelectorAll(a);Array.prototype.forEach.call(c,function(a){L(a,b)})}else a instanceof Array||a instanceof NodeList?Array.prototype.forEach.call(a,function(a){L(a,b)}):(c=document.createEvent("HTMLEvents"),c.initEvent(b,e,e),a.dispatchEvent(c))}function qa(a,b){for(var c=0;c<a.length;c++){var d=a[c];if(d)if("string"===typeof d){if(d=ja(d))M(d),b&&(50<d.length&&(d=d.substr(d.length-50)),N(b,d))}else Array.isArray(d)&&qa(d,b)}};function O(a){if(window.CSS&&"function"===typeof window.CSS.escape)O=function(a){return window.CSS.escape.call(window.CSS,a)};else{var b=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g,c=function(a,b){return b?"\x00"===a?"\ufffd":a.slice(0,-1)+"\\"+a.charCodeAt(a.length-1).toString(16)+" ":"\\"+a};O=function(a){return(a+"").replace(b,c)}}return O(a)};function P(){return!(!window.ClickTaleMonitor||!("function"===typeof window.ClickTaleMonitor.isMonitoring&&window.ClickTaleMonitor.isMonitoring()))}function N(a,b){window.ClickTaleMonitor&&"function"===typeof ClickTaleMonitor.addPageTag&&(N=function(a,b){!isNaN(a)&&b&&ClickTaleMonitor.addPageTag(a,b)},N(a,b))}
function ra(a,b,c){c=c||500;if(P()&&sa){sa=l;var d=ClickTaleMonitor.Settings.get(),f=d.shouldStartMonitorCallback||m(),h="";d&&d.config&&d.config.transport&&(h=d.config.transport.url||"");ClickTaleMonitor.stop();d=ClickTaleMonitor.Settings.get();h&&d.configure({transport:{url:h}});"function"===typeof d.shouldStartMonitor&&d.shouldStartMonitor(f);ClickTaleMonitor.restart(a,b);setTimeout(function(){sa=e},c)}}var sa=e,Q,R,S,T=l,ta=l,ua=l;function U(){"function"===typeof ClickTaleStop&&ClickTaleStop()}function M(a,b){"function"===typeof ClickTaleEvent&&(b?M.b[a]!==e&&(M.b[a]=e,ClickTaleEvent(a)):ClickTaleEvent(a))}M.b={};function va(a){"function"===typeof window.ClickTaleRegisterElementAction&&ClickTaleRegisterElementAction("click",a)}function wa(a,b){var c={},d;for(d in a)c[d]=a[d];c.target=b;c.srcElement=b;va(c)}window.ClickTaleDetectAgent&&window.ClickTaleDetectAgent()&&window.ClickTaleDetectAgent();
function xa(a,b){"object"==typeof a&&"string"==typeof b&&(window.ClickTaleContext&&-1!=document.referrer.indexOf(location.hostname)&&window.parent.ct&&window.parent.ct.ElementAddressing&&"function"===typeof window.parent.ct.ElementAddressing.setCustomElementID?window.parent.ct.ElementAddressing.setCustomElementID(a,b):(!window.ClickTaleContext&&"function"===typeof ClickTaleSetCustomElementID&&-1!=ClickTaleSetCustomElementID.toString().indexOf("duplicate registration of custom id")?xa=function(a,b){a.ClickTale=
a.ClickTale||{};a.ClickTale.CustomID=b}:window.ClickTaleSetCustomElementID=window.ClickTaleSetCustomElementID||function(a,b){a.ClickTale=a.ClickTale||{};a.ClickTale.CustomID=b},window.ClickTaleSetCustomElementID(a,b)))}
function ya(){Array.prototype.forEach.call(document.querySelectorAll("[id]"),function(a){if(!D(a,'input[type="hidden"]')){var b=a.getAttribute("id");b.match(/(?:\r|\n)/)&&"function"===typeof ClickTaleNote&&ClickTaleNote("ctlib.api.SetCustomElementIdDuplicates: ids with line break found!");var a=document.querySelectorAll('[id="'+O(b)+'"]'),c=za;1<a.length&&!c[b]&&(c[b]=e,Array.prototype.forEach.call(a,function(a,c){xa(a,b.replace(/(\r|\n|\r\n|\s+)+/g,"_").replace(/\W/g,"_")+"_"+c)}))}})}var za={};
function V(){return"function"===typeof ClickTaleIsRecording?ClickTaleIsRecording():l}function Aa(a,b){"function"===typeof ClickTaleLogical&&(M.b={},za={},b?ClickTaleLogical(a,b):ClickTaleLogical(a))}function K(){if("function"===typeof ClickTaleDetectAgent){var a=ClickTaleDetectAgent();if(a)return K=function(){return a},K()}return g}function Ba(){"function"===typeof ClickTaleUploadPage&&ClickTaleUploadPage(void 0,void 0)}
function Ca(a){if("function"===typeof ClickTaleRegisterTouchAction){var b=a.getBoundingClientRect();ClickTaleRegisterTouchAction(a,b.left+document.body.scrollLeft,b.top+document.body.scrollTop)}}
function Da(a,b,c){if(!a){a="mousedown";if("boolean"!=typeof W){var d=K();d&&(W=d.m)}W&&(a="touchstart")}W||I(document,a,c||"img, a, button, textarea, input, select",function(a){var d=a.target,i=this;(!b||!D(this,b))&&J(d,function(a,b){return function(){if(D(this,c||"button,a,textarea")&&this!=a)wa(b,this);else{var d=m();document.addEventListener("click",function(a){return d=function(b){b.target===a&&(Ea=e);document.removeEventListener("click",arguments.callee,l)}}(a),l);setTimeout(function(){Ea||
va(b);document.removeEventListener("click",d,l);Ea=void 0},200)}}.bind(i)}(d,a))})}var W,Ea;function X(a,b,c,d){X.d&&(X.d=l,d=d||400,"number"==typeof c&&(d=c,c=""),b=b||document.location.href,U(),window.ClickTaleIncludedOnDOMReady=e,window.ClickTaleIncludedOnWindowLoad=e,Ba(),Aa(b,c),a(),setTimeout(function(){X.d=e},d))}X.d=e;
function Fa(){var a,b=Ga,c=document.location,d=Ha,f=Ka;La&&(La=l,a=a||400,f&&(U(),window.ClickTaleIncludedOnDOMReady=e,window.ClickTaleIncludedOnWindowLoad=e,Ba(),Aa(c.href,d)),ra(c,d),b(),setTimeout(function(){La=e},a))}var La=e;function Ma(a){"function"===typeof ClickTaleAddAugmentElementPathHandler&&ClickTaleAddAugmentElementPathHandler("Linkanalytics",a)}
function Na(){var a=[[".msame_Header .msame_Header_name",e]];Oa=a;var b="";a.forEach(function(a){a[1]===e&&(b+=","+a[0])});b&&Da("","",b.replace(/^,/,""));Ma(function(a){return function(b){for(var f=0,h=a.length;f<h;f++){var i=a[f];if(b&&D(b,i[0])){var G=i[2];if("function"!=typeof G||G())return{data:{interesting:i[1]}}}}return g}}(Oa))}var Oa=[];function Pa(a){"function"===typeof ClickTaleExec&&ClickTaleExec(a)}var Y=M;function Qa(){var a=Z.toString();"function"===typeof ClickTaleField&&ClickTaleField("isMobile",a)};var Ka=l,Z=l,Ra=e,Ha=location.href;function Sa(){"boolean"===typeof Z&&Qa()}
function Ga(){ya();Ha=location.href;if(Ra)Ra=l;else for(var a=window.ClickTaleSettings&&window.ClickTaleSettings.PTC&&window.ClickTaleSettings.PTC.InitFuncs?window.ClickTaleSettings.PTC.InitFuncs:[],b=0,c=a.length;b<c;b++)if("function"===typeof a[b])a[b]();Ka?Sa():H(function(){Ka=e;Sa()});document.querySelector(".msame_Header .msame_Header_name")&&Na();"support.microsoft.com"===document.location.host&&(a=document.cookie,-1<a.indexOf("smc_f=")&&(a=a.split("smc_f="),2===a.length&&(a=a[1].split(";"),
a=a[0].split("|"),b=document.title,1<a.length&&b&&Y("Onload | "+b+" | "+a[2],e))))}
function Ta(){jQuery(document).on("keypress","#searchFormInputTxt",function(){var a=jQuery(this);a.is("#searchFormInputTxt")&&((a=a.val())&&Pa("jQuery('#searchFormInputTxt').val(unescape('"+escape(a)+"'));"),Y("Action | All Pages | Interacted with Search field",e))});var a=Z?"touchstart":"mousedown";jQuery(document).on(a,"#searchFormInputTxt, #skylight-entry-chrome, #all-products-link",function(a){var c=jQuery(this);c.is("#searchFormInputTxt")&&Y("Action | All Pages | Interacted with Search field",
e);if(0<c.closest("#skylight-entry-chrome").length){var d=c.closest("#skylight-entry-chrome");0<d.length&&(Y("Action | Clicked on Try Virtual Agent",e),Z?Ca(d[0]):wa(a,d[0]),L(document.body,"keydown"))}c.is("#all-products-link")&&(Y("Action | Clicked on View all Microsoft products",e),Z?Ca(a.target):wa(a,a.target),L(document.body,"keydown"))})}
function Ua(){if(!window.ClickTaleFirstPCCGo){window.ClickTaleFirstPCCGo=e;var a=K();a&&(Z=a.m,Qa());Ga();Ta();jQuery(document).on("input","#search-text",function(){var a=jQuery(this).val();Pa('jQuery("#search-text").val("'+a+'");')})}}
(function(a){function b(){2==++ma&&a()}na(b);if("function"==typeof ClickTale)b();else{var c=window.ClickTaleOnRecording||m();window.ClickTaleOnRecording=function(){b();return c.apply(this,arguments)}}})(function(){Da();C(Ua,function(){return window.jQuery&&("function"===typeof jQuery.fn.on||"function"===typeof jQuery.fn.delegate)?e:l},250,40)});window.clickTaleStartEventSignal=function(a){Fa();a&&"string"===typeof a&&Y(a)};
window.clickTaleEndEventSignal=function(){Q&&(history.replaceState=Q);R&&(history.pushState=R);S&&window.removeEventListener("popstate",S,l);U()};
(function(a,b,c,d){function f(){ta&&X(a,location.href,i,c);(P()||ua)&&ra(document.location,i,c);i=location.href;T=l}function h(){V()&&(ta=e,U());d()?T=e:b?"string"===typeof b?C(f,function(){return!!document.querySelector(b+"")},1E3,10,f):"function"===typeof b?C(f,b,1E3,10,f):setTimeout(f,2E3):setTimeout(f,2E3)}var d=d||function(){return l},a=a||m(),i=location.href;!c&&!isNaN(b)&&(c=b,b="");c=c||2E3;window.history&&(Q=history.replaceState,history.replaceState=function(){var a=Q.apply(history,arguments);
V()||P()||T?h():history.replaceState=Q;return a},R=history.pushState,history.pushState=function(){var a=R.apply(history,arguments);V()||P()||T?h():history.pushState=R;return a},S=function(){V()||P()||T?setTimeout(h,50):window.removeEventListener("popstate",arguments.callee,l)},window.addEventListener("popstate",S,l))})(Ga);
window.ClicktaleIntegrationExperienceHandler=function(a,b,c){var d;return function(){var f=this,h=arguments,i=c&&!d;clearTimeout(d);d=setTimeout(function(){d=g;c||a.apply(f,h)},b);i&&a.apply(f,h)}}(function(){Fa();arguments.length&&qa(arguments)},400,l);})();} }, function () { return !!(window.ClickTaleSettings && window.ClickTaleSettings.PTC && typeof window.ClickTaleSettings.PTC.okToRunPCC != 'undefined'); }, 500, 20);

